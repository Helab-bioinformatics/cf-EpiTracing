XGBoost machine learning models were developed to: (1) classify CRC patients and healthy individuals, and detect early colorectal precancerous lesions (CRA); and (2) diagnose and grade DLBCL patients at different stages. For each application, the models were designed with clear separation of training and independent validation groups. The models were trained and tuned using only the data from the training group. To optimize model performance, Bayesian optimization was employed to fine-tune key hyperparameters, including max depth, learning rate (eta), gamma, subsample ratio, colsample bytree, min child weight, alpha, lambda and scale pos weight. The optimization process for classification models aimed to maximize the area under the receiver operating characteristic curve (AUC) and was conducted using 10-fold cross-validation over multiple iterations. For the regression models, optimization aimed to minimize Root Mean Squared Error (RMSE) through similar cross-validation methods.
The models and training codes have been available at https://github.com/Helab-bioinformatics/cf-EpiTracing. Comprehensive evaluations for overfitting, bias, class imbalance, robustness, and reliability were conducted for each model. Overfitting was assessed and controlled through comparison of training and validation accuracy across training iterations (learning curves) and using 10-fold cross-validation in parameter tuning. Bias and class imbalance were evaluated using confusion matrices, while robustness and reliability were measured by accuracy, precision, recall, F1 score and AUC (for classifier model) and mean absolute error (MAE), root mean square error (RMSE, for regression model). Performance was assessed in an external validation cohort to further evaluate the reliability and generalizability of the models.
Of note, samples from the validation group were sourced from independent medical center and separate patient cohort. CRC samples (n=75) from the training group were collected exclusively from the Shanghai Tongren Hospital, Hongqiao International Institute of Medicine, while the CRC samples in the validation cohort (n=32) were obtained from Ruijin Hospital, affiliated with Shanghai Jiao Tong University School of Medicine. Healthy donor samples in the training group (n=93) were collected from Peking University Third Hospital, with those in the validation group (n=32) sourced from the Chinese PLA General Hospital. DLBCL samples in both the training (n=133) and validation groups (n=37) were obtained from Peking University Third Hospital, but from distinct patient cohorts.
To evaluate the generalization capability of the CRC-Healthy classifier, it was applied to adenoma samples (CRA), which were an unseen subset of pre-cancerous data. Each CRA sample was classified as either CRC or healthy based on a 0.5 probability threshold. Samples with predicted probabilities â‰¥0.5 were considered correctly detected as CRA.
For the DLBCL score regression model, the expected DLBCL scores for healthy individuals and patients in stages I, II, III, and IV were set to 0, 1, 2, 3 and 4, respectively. The Youden index was utilized to determine the optimal cutoff for DLBCL scores in the classification of training group samples, and this cutoff was subsequently applied to the validation group samples (Fig. 5k).
